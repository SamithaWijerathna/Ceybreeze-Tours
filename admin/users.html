<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Users</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
<style>
body { display:flex; min-height:100vh; overflow:auto; }
.sidebar { min-width:220px; background:#212529; color:white; }
.sidebar a { display:flex; align-items:center; color:white; padding:12px; text-decoration:none; border-radius:5px; margin-bottom:5px; }
.sidebar a:hover { background:#495057; }
.sidebar a i { margin-right:10px; }
.sidebar h4 { color:#f8f9fa; margin-bottom:20px; }
.main-content { flex:1; padding:20px; background:#f8f9fa; overflow-y:auto; }
.card { min-height:120px; }
</style>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar p-3">
  <h4><i class="fas fa-cogs"></i> Admin Panel</h4><hr>
  <a href="dashboard.html"><i class="fas fa-home"></i> Dashboard</a>
  <a href="bookings.html"><i class="fas fa-calendar-check"></i> Bookings</a>
  <a href="tour-packages.html"><i class="fas fa-suitcase-rolling"></i> Tour Packages</a>
  <a href="prices-upgrade.html"><i class="fas fa-tags"></i> Prices Upgrade</a>
  <a href="homepage-slider.html"><i class="fas fa-images"></i> Homepage Slider</a>
  <a href="users.html"><i class="fas fa-users"></i> Users</a>
  <a href="contacts.html"><i class="fas fa-envelope"></i> Contact Messages</a>
  <a href="newsletter.html"><i class="fas fa-paper-plane"></i> NewsLetter</a>
  <a href="offers.html" class="active-page"><i class="fas fa-gift"></i> Offers</a>
  <a href="settings.html"><i class="fas fa-cog"></i> Settings</a>
  <a href="#" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</a>
</div>

<div class="main-content">
  <h2>Registered Users</h2>
  <p>Total Users: <span id="totalUsers">0</span></p>
  <table class="table table-bordered" id="usersTable">
    <thead class="table-light">
      <tr><th>Name</th><th>Username</th><th>Email</th><th>UID</th></tr>
    </thead>
    <tbody>
      <tr><td colspan="4" class="text-center">Loading users...</td></tr>
    </tbody>
  </table>
</div>

<!-- Firebase JS SDK -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyBz253Eiif34B28FdWiX51UmlbUF3dc-E0",
    authDomain: "ceybreeze-tours-3443d.firebaseapp.com",
    projectId: "ceybreeze-tours-3443d",
    storageBucket: "ceybreeze-tours-3443d.firebasestorage.app",
    messagingSenderId: "94148437936",
    appId: "1:94148437936:web:4de667cfc522c502c05875",
    measurementId: "G-JB0916EC12"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  async function loadUsers() {
    const usersTableBody = document.querySelector("#usersTable tbody");
    const totalUsersSpan = document.getElementById("totalUsers");
    usersTableBody.innerHTML = `<tr><td colspan="4" class="text-center">Loading users...</td></tr>`;

    try {
      const snapshot = await db.collection("users").orderBy("createdAt", "desc").get();
      const users = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

      totalUsersSpan.textContent = users.length;

      if (users.length === 0) {
        usersTableBody.innerHTML = `<tr><td colspan="4" class="text-center">No registered users yet</td></tr>`;
        return;
      }

      usersTableBody.innerHTML = "";
      users.forEach(user => {
        usersTableBody.innerHTML += `
          <tr>
            <td>${user.firstName} ${user.lastName}</td>
            <td>${user.username}</td>
            <td>${user.email}</td>
            <td>${user.id}</td>
          </tr>
        `;
      });

    } catch (error) {
      console.error("Error loading users:", error);
      usersTableBody.innerHTML = `<tr><td colspan="4" class="text-center text-danger">Error loading users</td></tr>`;
    }
  }

  // Load users on page load
  loadUsers();
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
