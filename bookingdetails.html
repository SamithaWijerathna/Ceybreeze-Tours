<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Booking Details</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body class="p-4">

  <div class="container">
    <h2>Booking Details</h2>
    <p id="userHeader" class="text-muted">Loading...</p>
    <div id="bookingInfo" class="mt-4"></div>
  </div>

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

  <script>
    // Firebase config
    const firebaseConfig = {
apiKey: "AIzaSyBz253Eiif34B28FdWiX51UmlbUF3dc-E0",
  authDomain: "ceybreeze-tours-3443d.firebaseapp.com",
  projectId: "ceybreeze-tours-3443d",
  storageBucket: "ceybreeze-tours-3443d.firebasestorage.app",
  messagingSenderId: "94148437936",
  appId: "1:94148437936:web:4de667cfc522c502c05875",
  measurementId: "G-JB0916EC12"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Helper to get URL query parameter
    function getQueryParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

    const username = getQueryParam("username");
    document.getElementById("userHeader").textContent = "Booking details for: " + username;

    const container = document.getElementById("bookingInfo");

    // Fetch booking info for that username
    db.collection("bookings").where("userName", "==", username).get()
      .then(snapshot => {
        if (snapshot.empty) {
          container.innerHTML = "<p class='text-danger'>No bookings found for this user.</p>";
        } else {
          snapshot.forEach(doc => {
            const data = doc.data();
            const fields = [
              "ageGroup", "carSeat", "days", "destination", "foodPreferences",
              "roomType", "specialNotes", "stayType", "travelGuide", "travelers",
              "userId", "vehicle"
            ];

            let html = "<div class='card p-3 mb-3'><ul class='list-group'>";
            fields.forEach(field => {
              html += `<li class='list-group-item'><strong>${field}:</strong> ${data[field] || "N/A"}</li>`;
            });
            html += "</ul></div>";
            container.innerHTML += html;
          });
        }
      })
      .catch(error => {
        console.error("Error loading booking details:", error);
        container.innerHTML = "<p class='text-danger'>Failed to load booking data.</p>";
      });
  </script>
</body>
</html>
